<!DOCTYPE html>
<html>
    <head>
		<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
		<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>

		<title>SG Promotions</title>
        <link rel="stylesheet" href="css/sg.promotions.css" />
        <link rel="stylesheet" href="jquery.mobile-1.1.0-rc.1.min.css" />
        <link rel="stylesheet" href="css/sg.promotions.custom.css" type="text/css" />
        <link href="css/sg.promotions.restpages.css" rel="stylesheet" type="text/css" />
        <script src="jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="jquery.easing.1.3.js"></script>
        <script type="text/javascript" src="jquery.jsonp-2.2.1.js"></script>
        <script type="text/javascript" src="jsrender.js"></script>

        <script type="text/javascript" src="promotions.js"></script>
        <script src="jquery.mobile-1.1.0-rc.1.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="cordova-1.5.0.js"></script>
        <!--<script type="text/javascript" charset="utf-8" src="phonegapMock.js"></script>-->
        <script type="text/javascript">
            document.addEventListener("deviceready",onDeviceReady,false);
            // once the device ready event fires, you can safely do your thing! -jm
            function onDeviceReady() {
                tombstoneSave();
            }
        </script>
	</head>
<body>

<div data-role="page" id="nearby" data-theme="c">
    <script type="text/javascript">
        $('#nearby').live('pagebeforehide', function (event, ui) {
            stopProgressBar();
        });
        $('#nearby').live('pagebeforeshow', function (event, ui) {
            getNearby();
        });
        $('#nearby').live('pageshow', function (event, ui) {
            startProgressBar();
        });
    </script>
	<div data-role="content" id="nearby-content">
        <div class="progress" id="progress">
            <div class="pip"></div>
            <div class="pip"></div>
            <div class="pip"></div>
            <div class="pip"></div>
            <div class="pip"></div>
        </div>
		<h1>choose a promotion</h1>
        <div id="nearby-result">
        	<p>Searching for promotions...</p>
        </div>
	</div>

    <script id="NearbyTemplate" type="text/x-jsrender">
        <h3><span id="count"></span> promotion(s) found: </h3><p/>
        <ul data-role="listview" id="nearby-list" data-inset="true" data-filter="true">
            {{for results}}
            <li data-category="{{:category}}" data-distance="{{:distance}}" data-contact_number="{{:contact_number}}" data-contact_number_link="{{:contact_number_link}}" data-name="{{:name}}" data-promo="{{:promo}}" data-pic="{{:pic}}" data-operating_hours="{{:operating_hours}}" data-url="{{:url}}" data-expiry_date="{{:expiry_date}}" data-address="{{:address}}" data-lat="{{:lat}}" data-lng="{{:lng}}">
                <a href="promotion.html">
                    <img src="{{:pic}}" width="24" height="24" class="ui-li-icon" style="top: 25px"/>
                    <h3 class="black">{{:name}}</h3>
                    <p class="black">{{:promo}}</p>
                    <span class="ui-li-count">{{:distance}}m</span>
                </a>
            </li>
            {{/for}}
        </ul>
    </script>

    <script id="NearbyEmptyTemplate" type="text/x-jsrender">
        <p>There are no results. Please choose another <a href="javascript:history.back()">category</a>.</p>
    </script>

    <script id="NearbyErrorTemplate" type="text/x-jsrender">
        <p>An error occured while loading, please <a href="nearby.html">reload</a> to try again or go <a href="javascript:history.back()">back</a>.</p>
    </script>
</div>
</body>
</html>